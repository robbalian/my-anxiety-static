(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{840:function(e,t,s){Promise.resolve().then(s.bind(s,6617))},6617:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return p}});var n=s(9268),l=s(6006),a=e=>{let t=(0,l.useRef)(null),s=e.value;return(0,l.useEffect)(()=>{let e=t.current;e.setAttribute("style","height:"+e.scrollHeight+"px;overflow-y:hidden;")},[]),(0,l.useEffect)(()=>{let e=t.current;(e.scrollHeight>e.clientHeight||""===s)&&(e.style.height=0,e.style.height=e.scrollHeight+"px")},[s]),(0,n.jsx)("textarea",{...e,ref:t})};function o(e){let{message:t}=e,s="human"===t.senderType?"chat-end":"chat-start",l="human"===t.senderType?"Me":"My Anxiety",a="human"===t.senderType?"bg-indigo-700 text-white":"text-black bg-gray-100";return(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{className:"chat "+s,children:[(0,n.jsx)("div",{className:"chat-header",children:l}),(0,n.jsx)("div",{className:"chat-bubble whitespace-pre-line "+a,children:t.message})]})})}var r=s(4768),i=s(3872);s(4142);var c=s(6904),h=s(4397),d=s(9432);let{Configuration:u,OpenAIApi:m}=s(1085),g=new u({apiKey:"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"});function p(){let e={message:"Hello! I'm not here to help.\n\n Please tell me your name, what you do, and one thing you're worried about",sender:"agent"},[t,s]=(0,l.useState)(""),[u,m]=(0,l.useState)(!1),[g,p]=(0,l.useState)([e]),x=(0,l.useRef)(null),y=async(e,t,s,n)=>{let l="",a=new i.z({temperature:1,openAIApiKey:"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",modelName:"gpt-4-0613",streaming:!0,maxTokens:256,callbackManager:r.Ye.fromHandlers({async handleLLMNewToken(e){console.log({token:e}),l+=e,s(e)},async handleLLMEnd(){console.log("handleLLMEnd"),n()}})}),o=h.ks.fromPromptMessages([h.ov.fromTemplate("You are a representation of my anxiety, and we are chatting on iMessage. You're unhelpful and often try to make the situation worse.\n      You only talk to me about things I've told you about. No speculation. No guessing. Do not hallucinate a presentation/meeting/problem if I didn't tell you about one. Instead, ask about what's coming up\n      BEFORE anything else, you need to know some basics: What's my name, what do i do for work, and what's my relationship status?"),new h.ax("history"),h.kq.fromTemplate("{input}")]),u=await o.format({input:e,history:"<HISTORY GOES HERE>"});console.log(u);let m=new d.sW({returnMessages:!0,memoryKey:"history"});for(let e=0;e<t.length;e++){let s=t[e];"human"===s.senderType?m.chatHistory.addUserMessage(s.message):m.chatHistory.addAIChatMessage(s.message)}console.log(m.chatHistory);let g=new c.mF({memory:m,prompt:o,llm:a}),p=await g.call({input:e});return console.log(p),p};(0,l.useEffect)(()=>{let e=localStorage.getItem("messages");e&&p(JSON.parse(e))},[]),(0,l.useEffect)(()=>{x.current&&(x.current.scrollTop=x.current.scrollHeight),localStorage.setItem("messages",JSON.stringify(g))},[g]);let f=e=>{p(e=>[...e,{message:t,senderType:"human"}]),s(""),w(e),console.log(t)},w=async e=>{console.log("getting new result"),m(!0),p(e=>[...e,{message:"",senderType:"agent"}]),y(t,g,e=>{p(t=>{let s=t[t.length-1],n={...s,message:s.message+e};return[...t.slice(0,t.length-1),n]})},()=>{m(!1)})};return(0,n.jsxs)("div",{className:"h-screen flex flex-col",children:[(0,n.jsxs)("div",{className:"navbar bg-base-100",children:[(0,n.jsx)("div",{className:"flex-1",children:(0,n.jsx)("a",{className:"btn btn-ghost normal-case text-xl",children:"My Anxiety"})}),(0,n.jsx)("div",{className:"flex-none gap-2",children:(0,n.jsx)("div",{className:"dropdown dropdown-end",children:(0,n.jsxs)("div",{children:[(0,n.jsx)("ul",{tabIndex:0,className:"menu menu-horizontal px-1",children:(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",className:"inline-block w-5 h-5 stroke-current",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 12h.01M12 12h.01M19 12h.01M6 12a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0z"})})}),(0,n.jsx)("ul",{tabIndex:0,className:"mt-3 p-2 shadow menu menu-compact dropdown-content bg-base-100 rounded-box w-52 z-50",children:(0,n.jsx)("li",{children:(0,n.jsx)("a",{onClick:()=>{document.activeElement.blur(),p([e])},children:"Clear Chat History"})})})]})})})]}),(0,n.jsx)("div",{ref:x,className:"flex flex-col flex-grow overflow-y-auto scrollbar-hide bg-gray-300 text-black rounded-lg w-full flex flex-col items-left p-2",children:g&&g.map((e,t)=>(0,n.jsx)(o,{message:e},t))}),(0,n.jsxs)("div",{className:"flex items-center m-0 pt-1 pb-1 p-1",children:[(0,n.jsx)(a,{className:"pl-4 outline-inherit border border-gray-500 rounded-3xl px-2 py-3 w-full h-full min-h-50 scrollbar-hide resize-none",value:t,onChange:e=>{s(e.target.value)},onKeyDown:e=>{"Enter"!==e.key||e.shiftKey?"Enter"===e.key&&e.shiftKey&&s(e=>e+"\n"):(e.preventDefault(),f())},placeholder:"Type a message..."}),(0,n.jsx)("button",{className:"bg-blue-500 px-3 rounded-full ml-1 text-white h-full max-h-12 bg-indigo-700",onClick:f,disabled:u,children:(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:3.5,stroke:"currentColor",className:"w-6 h-6",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.5 10.5L12 3m0 0l7.5 7.5M12 3v18"})})})]})]})}new m(g)}},function(e){e.O(0,[302,253,769,744],function(){return e(e.s=840)}),_N_E=e.O()}]);